# Предсказание целевых действий на сайте 'СберАвтоподписка'

Проект в качестве итогового задания по курсу 'Введение в Data Science' от Skillbox.
Презентация с комментариями в Google Slides: https://docs.google.com/presentation/d/1oFvF22GGozbajsk-j8WMtyQqg1YqQ_qk7pcXOeSmjCE/edit?usp=sharing

**Цель** - предсказать совершение пользователем одного из целевых действий - 'Оставить заявку' или 'Заказать звонок' по времени визита 'visit_\*', рекламным меткам 'utm_\*', характеристикам устройства 'device_\*' и местоположению 'geo_\*'.

Целевые **метрики**: `roc-auc` > 0.65, время предсказания не более 3 секунд.


## Блокноты

Ноутбуки с разведовательным анализом данных и исследованием моделей для задачи вынесены в отдельную папку `notebooks`. К ним же скопирован файл с дополнительными данными `additional_data.py` для независимости от остального проекта.

## Обучение модели

Для создания модели необходимо запустить скрипт `create_model.py` (файл `additional_data.py` и папки с данными `data` и моделями `models` должны находится в той же директории).

Или можно создать модель, запустив ноутбук с исследованиями моделей.

## Запуск приложения

Модель оформлена в качестве отдельного приложения, находящегося в папке `app`. Чтобы его запустить, необходимо установить библиотеки из `requirements.txt` и в корневой папке проекта выполнить команду:  

```
uvicorn app:app --host 0.0.0.0 --port 8000
```

Также приложение может быть запущено с помощью Docker. Для этого нужно выполнить в корневой папке проекта команды для построения образа и запуска `docker-compose` (возможно с `sudo`):
```
docker-compose build
docker-compose up

# для выключения docker-compose
docker-compose down
```
Папка с моделями `models` подключается как внешний том в `docker-compose.yml`.

В любом случае приложение будет доступно по адресу `http://127.0.0.1:8000`.

## Методы API

Для работы с приложением можно использовать запросы: 
+ `/status` (get) - для получения статуса сервиса;
+ `/version` (get) - для получения версии и метаданных модели;
+ `/predict` (post) - для предсказания класса одного объекта;
+ `/predict_many` (post) - для предсказания класса множества объектов;
+ `/predict_proba` (post) - для предсказания вероятности положительного класса одного объекта;
+ `/predict_proba_many` (post) - для предсказания вероятности положительного класса множества объектов.

Все эти методы можно быстро протестировать с помощью скрипта `test_app.py`.
